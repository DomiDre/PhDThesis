\providecommand{\main}{../../..}
\documentclass[\main/dresen_thesis.tex]{subfiles}

\begin{document}
  \section{Neutron Reflectometry (NR)}
    \label{ch:methods:nr}
    Neutron reflectometry can be discussed in the same framework as X-ray reflectometry.
    Instead of probing the vertical electron density, the average nuclear structure of the layers is studied.
    Using furthermore polarized neutrons, the magnetic spin density of the layers can be determined in polarized neutron reflectometry (PNR).

    The PNR experiments presented in this thesis were performed at the ILL beamlines SuperADAM (\refapp{ch:appendix:lss:superadam}) and D17 (\refapp{ch:appendix:lss:d17}), as well as the MLZ beamline MARIA (\refapp{ch:appendix:lss:maria}), which all measure the reflected neutron beam on a position-sensitive detector.
    To measure the scattered reflectivity of the polarized neutrons in the experiments at MARIA and SuperADAM, the angle from sample to source and detector is varied and monochromatic neutrons are measured on a detector at specular condition, analogue to XRR.
    The alignment procedure differs in so far that the used silicon substrates are relatively transparent for neutrons and therefore no absorption curve can be reliably measured.
    Therefore, initially a laser pointer is used to pre-align the sample and the final alignment is performed by observing the intensity of the reflected beam on the position-sensitive detector, while moving the sample.
    The reflectivity is then measured for varied scattering vectors, by rotating the sample for an angle $\theta$ and the detector for an angle $2 \theta$ simultaneously, where then the neutrons are integrated until the counting statistic is sufficiently above the noise level.
    From the reflectivity experiment, two-dimensional detector data sets are obtained for each measured angle, which are stored together in a HDF5 data format \cite{HDF5_1997_Hiera}.
    The usual reflectometry leave the beam width perpendicular to the scattering angle relatively and therefore have no resolution in this direction, such that the data can be integrated along this dimension.
    The integrated data can then be plotted in a two dimensional image, where one dimension are the pixel coordinates $z$ along the scattering angle and the other the incident angle for the respective line.
    By determining the center bin $z_c$ and using the sample-to-detector distance $L_\mathrm{SDD}$, the coordinate axis can be transformed to the coordinate system spanned by $\alpha_i - \alpha_o,\,\alpha_i+\alpha_o$ by calculating $\alpha_f$ for each point
    \begin{align}
      \alpha_f \eq \alpha_i + \arctan\biggl( \frac{z-z_c}{L_\mathrm{SDD}}\biggr).
    \end{align}
    The data can then be analyzed in this natural coordinate system, which directly relates to $q_z$ for the vertical axis.
    Thus, the reflectivity curve is obtained by integrating a slice around the center of the data in the new coordinate system where $\alpha_i \eq \alpha_o$.
    To correct the data for contributions from diffuse scattering, regions for background can be sliced in the off specular area of the data for subtraction.
    If the data allows for more precision, it is also possible to walk through the data for each line and perform fits of multiple Gaussian functions, to separate specular and diffuse scattering.

    It is noted that as the coordinate system is distorted and rotated by this transformation, a rebinning protocol needs to be chosen before the reflectivity can be obtained in respect to $q_z$.
    In this thesis, a pixel splitting procedure was chosen, where for each pixel of the experimental in the coordinate system $(z,\,\alpha_i)$ the transformation to $(\alpha_i - \alpha_o,\, \alpha_i+\alpha_o)$ is done for all four corners.
    Then the new rectangular coordinate grid is placed on top of this distorted and rotated mesh, and the polygon overlap is with each other is determined for each new bin.
    The intensity and monitor value of each bin is then the sum of all overlapping pixels, which contribute with the fraction of their overlap area to their respective total area.
    While the pixel splitting protocol is more difficult to implement than the nearest neighbour approximation, where each pixel is just associated by it's central value to the nearest bin, it allows to keep the resolution of the original data without artificially worsening it or introducing artifacts by the coordinate transformation.

    An alternative way to measure the neutron reflectivity with respect to the scattering vector is by fixing the incident angle for varied wavelengths.
    This has the advantage that a large $q$-range is measured simultaneously without having to move the sample.
    For this purpose, the instrument D17 was used time-of-flight (TOF) mode, where a broad wavelength spectrum is directed on the sample in time-delayed packages.
    The reflectivity is measured on a time-resolved detector, from which the neutrons arriving at different times can be sorted to their respective wavelength and thereby $q$ value.
    The $q$-range can be tuned by changing the fixed incident angle.
    Due to the different measurement principle, no footprint correction is applied in data measured in TOF mode.
    However, it is still necessary to apply scaling factors to the data sets obtained for the different incident angles.
    Therefore, care is taken during measurement that all data sets have regions of overlap for their $q$-ranges, such that they can be mutually overlapped and the initial plateau is the reference point that can be scaled to one.
    For the data treatment and reduction of D17 data, the software COSMOS \cite{Gutfreund_2018_Towar} is used and focus can be set on the model discussions.


\end{document}